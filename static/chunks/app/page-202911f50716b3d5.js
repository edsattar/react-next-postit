(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6744:function(e,t,s){Promise.resolve().then(s.bind(s,6658)),Promise.resolve().then(s.bind(s,8871))},8871:function(e,t,s){"use strict";s.r(t),s.d(t,{AllPosts:function(){return i}});var l=s(9268),n=s(4214),a=s(79),r=s(9677);let i=()=>{let e=async()=>{let{data:e}=await n.Z.get("/api/posts/getAllPost");return e},{data:t,isLoading:s,isError:i}=(0,r.a)(["allPosts"],e);return s?(0,l.jsx)("p",{children:"Loading..."}):i?(0,l.jsx)("p",{children:"Error"}):(0,l.jsx)(l.Fragment,{children:null==t?void 0:t.map(e=>(0,l.jsx)(a.Z,{post:e},e.id))})}},6658:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var l=s(9268),n=s(6006),a=s(5194),r=s(8867),i=s(4214),o=s(4732),d=s(8919);function c(){let[e,t]=(0,n.useState)(""),s=(0,a.NL)(),{mutate:c}=(0,r.D)(async e=>await i.Z.post("/api/posts/addPost",{title:e}),{onError:e=>{if(e instanceof o.d7){var t;d.ZP.dismiss(),d.ZP.error(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.data.message)}},onSuccess:()=>{d.ZP.dismiss(),d.ZP.success("Post created successfully"),s.invalidateQueries(["allPosts"]),s.invalidateQueries(["userPosts"]),t("")}}),u=async t=>{t.preventDefault(),c(e),d.ZP.loading("Creating post...")};return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("form",{onSubmit:u,className:"bg-white my-8 p-8 rounded-md",children:[(0,l.jsx)("div",{className:"flex flex-col my-4",children:(0,l.jsx)("textarea",{onChange:e=>t(e.target.value),name:"title",value:e,placeholder:"What's on your mind?",className:"p-4 text-lg rounded-md my-2 bg-gray-200"})}),(0,l.jsxs)("div",{className:" flex items-center justify-between gap-2",children:[(0,l.jsx)("p",{className:"font-bold text-sm ".concat(e.length>300?"text-red-700":"text-gray-700"),children:"".concat(e.length,"/300")}),(0,l.jsx)("button",{disabled:e.length>300||e.trim().length<1,className:"text-sm bg-teal-600 text-white py-2 px-6 rounded-xl disabled:opacity-25",type:"submit",children:"Create post"})]})]})})}},79:function(e,t,s){"use strict";s.d(t,{Z:function(){return h}});var l=s(9268),n=s(6394),a=s.n(n),r=s(5846),i=s.n(r),o=s(8919);function d(e){let{deletePost:t,setToggle:s}=e;return(0,l.jsx)("div",{onClick:e=>{e.stopPropagation(),s(!1)},className:"fixed bg-black/30 w-full h-full z-20 left-0 top-0 ",children:(0,l.jsxs)("div",{className:"absolute bg-white top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 p-12 rounded-lg flex flex-col gap-6",children:[(0,l.jsx)("h2",{className:"text-xl",children:"Are you sure you want to delete this post? \uD83D\uDE25"}),(0,l.jsx)("h3",{className:"text-red-600 text-sm",children:"Pressing the delete button will permenantly delete your post"}),(0,l.jsx)("button",{onClick:t,className:"bg-red-600 text-sm text-white py-2 px-4 rounded-md",children:"Delete Post"})]})})}var c=s(6006),u=s(5194),m=s(8867),x=s(4214);function h(e){var t;let{post:s,allowEdit:n}=e,[r,h]=(0,c.useState)(!1),p=(0,u.NL)(),{mutate:g}=(0,m.D)(async e=>await x.Z.delete("/api/posts/deletePost",{data:e}),{onSuccess:()=>{o.Am.remove(),o.Am.success("Post Deleted"),console.log("deleted"),p.invalidateQueries(["userPosts"]),p.invalidateQueries(["allPosts"]),p.invalidateQueries(["postDetail"])},onError:e=>{console.log("ERROR!!!")}}),f=()=>{o.Am.loading("Deleting Post..."),g(s.id)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"bg-white my-8 p-8 rounded-lg ",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(a(),{className:"rounded-full",width:32,height:32,src:s.user.image,alt:"avatar"}),(0,l.jsx)("h3",{className:"font-bold text-gray-700",children:s.user.name})]}),(0,l.jsx)("div",{className:"my-8 ",children:(0,l.jsx)("p",{className:"break-all",children:s.title})}),(0,l.jsxs)("div",{className:"flex gap-4 cursor-pointer items-center",children:[(0,l.jsx)(i(),{href:{pathname:"/post/".concat(s.id)},children:(0,l.jsxs)("p",{className:" text-sm font-bold text-gray-700",children:[null===(t=s.comments)||void 0===t?void 0:t.length," Comments"]})}),n&&(0,l.jsx)("button",{onClick:e=>h(!0),className:" text-sm font-bold text-red-500",children:"Delete"})]})]}),r&&(0,l.jsx)(d,{deletePost:f,setToggle:h})]})}},4732:function(e,t,s){"use strict";s.d(t,{d7:function(){return a}});var l=s(4214);let{Axios:n,AxiosError:a,CanceledError:r,isCancel:i,CancelToken:o,VERSION:d,all:c,Cancel:u,isAxiosError:m,spread:x,toFormData:h,AxiosHeaders:p,HttpStatusCode:g,formToJSON:f,mergeConfig:v}=l.Z}},function(e){e.O(0,[951,160,455,744],function(){return e(e.s=6744)}),_N_E=e.O()}]);