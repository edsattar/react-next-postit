(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[605],{6862:function(e,t,s){Promise.resolve().then(s.bind(s,5810))},5810:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return g}});var n=s(9268),l=s(79),a=s(6006),r=s(5194),i=s(8867),d=s(4214),o=s(4732),c=s(8919);function m(e){let{postId:t}=e,[s,l]=(0,a.useState)(""),m=(0,r.NL)(),{mutate:u}=(0,i.D)(async e=>{let{text:t,postId:s}=e;return await d.Z.post("/api/posts/addComment",{text:t,postId:s})},{onError:e=>{e instanceof o.d7&&(c.ZP.dismiss(),c.ZP.error("ERROR"))},onSuccess:()=>{m.invalidateQueries(["postDetail"]),c.ZP.dismiss(),c.ZP.success("Comment added"),l("")}}),x=async e=>{e.preventDefault(),u({text:s,postId:t}),c.ZP.loading("Adding your comment")};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("form",{onSubmit:x,className:"bg-white mb-8 p-8 rounded-md",children:[(0,n.jsx)("div",{className:"flex flex-col mb-4",children:(0,n.jsx)("input",{disabled:!1,onChange:e=>l(e.target.value),name:"title",value:s,type:"text",placeholder:"Enter your comment here",className:"p-4 text-lg rounded-md my-2 bg-gray-200"})}),(0,n.jsxs)("div",{className:" flex items-center justify-between gap-2",children:[(0,n.jsx)("p",{className:"font-bold text-sm ".concat(s.length>300?"text-red-700":"text-gray-700"),children:"".concat(s.length,"/300")}),(0,n.jsx)("button",{disabled:s.length>300||s.trim().length<1,className:"text-sm bg-teal-600 text-white py-2 px-6 rounded-xl disabled:opacity-25",type:"submit",children:"Add Comment"})]})]})})}var u=s(9677),x=s(6394),h=s.n(x);function p(e){var t;let{data:s}=e;return(0,n.jsx)(n.Fragment,{children:null===(t=s.comments)||void 0===t?void 0:t.map(e=>(0,n.jsxs)("div",{className:"bg-white my-8 p-8 rounded-lg ",children:[(0,n.jsx)("p",{className:"text-gray-700 pb-4",children:e.text}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(h(),{className:"rounded-full",width:24,height:24,src:e.user.image,alt:"avatar"}),(0,n.jsx)("h3",{className:"text-sm font-bold text-gray-700",children:e.user.name}),(0,n.jsx)("h2",{className:"text-xs",children:e.createdAt})]})]},e.id))})}function g(e){let{slug:t,enableComments:s=!0}=e,a=async e=>{let{data:t}=await d.Z.get("/api/posts/".concat(e));return t},{data:r,isLoading:i}=(0,u.a)(["postDetail"],()=>a(t));return i?(0,n.jsx)("div",{children:"Loading..."}):r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Z,{post:r}),s?(0,n.jsx)(m,{postId:r.id}):(0,n.jsx)("p",{children:"Login to post comments"}),(0,n.jsx)(p,{data:r})]}):(0,n.jsx)("h1",{children:"Post not found"})}},79:function(e,t,s){"use strict";s.d(t,{Z:function(){return h}});var n=s(9268),l=s(6394),a=s.n(l),r=s(5846),i=s.n(r),d=s(8919);function o(e){let{deletePost:t,setToggle:s}=e;return(0,n.jsx)("div",{onClick:e=>{e.stopPropagation(),s(!1)},className:"fixed bg-black/30 w-full h-full z-20 left-0 top-0 ",children:(0,n.jsxs)("div",{className:"absolute bg-white top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 p-12 rounded-lg flex flex-col gap-6",children:[(0,n.jsx)("h2",{className:"text-xl",children:"Are you sure you want to delete this post? \uD83D\uDE25"}),(0,n.jsx)("h3",{className:"text-red-600 text-sm",children:"Pressing the delete button will permenantly delete your post"}),(0,n.jsx)("button",{onClick:t,className:"bg-red-600 text-sm text-white py-2 px-4 rounded-md",children:"Delete Post"})]})})}var c=s(6006),m=s(5194),u=s(8867),x=s(4214);function h(e){var t;let{post:s,allowEdit:l}=e,[r,h]=(0,c.useState)(!1),p=(0,m.NL)(),{mutate:g}=(0,u.D)(async e=>await x.Z.delete("/api/posts/deletePost",{data:e}),{onSuccess:()=>{d.Am.remove(),d.Am.success("Post Deleted"),console.log("deleted"),p.invalidateQueries(["userPosts"]),p.invalidateQueries(["allPosts"]),p.invalidateQueries(["postDetail"])},onError:e=>{console.log("ERROR!!!")}}),f=()=>{d.Am.loading("Deleting Post..."),g(s.id)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"bg-white my-8 p-8 rounded-lg ",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(a(),{className:"rounded-full",width:32,height:32,src:s.user.image,alt:"avatar"}),(0,n.jsx)("h3",{className:"font-bold text-gray-700",children:s.user.name})]}),(0,n.jsx)("div",{className:"my-8 ",children:(0,n.jsx)("p",{className:"break-all",children:s.title})}),(0,n.jsxs)("div",{className:"flex gap-4 cursor-pointer items-center",children:[(0,n.jsx)(i(),{href:{pathname:"/post/".concat(s.id)},children:(0,n.jsxs)("p",{className:" text-sm font-bold text-gray-700",children:[null===(t=s.comments)||void 0===t?void 0:t.length," Comments"]})}),l&&(0,n.jsx)("button",{onClick:e=>h(!0),className:" text-sm font-bold text-red-500",children:"Delete"})]})]}),r&&(0,n.jsx)(o,{deletePost:f,setToggle:h})]})}},4732:function(e,t,s){"use strict";s.d(t,{d7:function(){return a}});var n=s(4214);let{Axios:l,AxiosError:a,CanceledError:r,isCancel:i,CancelToken:d,VERSION:o,all:c,Cancel:m,isAxiosError:u,spread:x,toFormData:h,AxiosHeaders:p,HttpStatusCode:g,formToJSON:f,mergeConfig:j}=n.Z}},function(e){e.O(0,[951,160,455,744],function(){return e(e.s=6862)}),_N_E=e.O()}]);